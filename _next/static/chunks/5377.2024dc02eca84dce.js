"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5377,8317],{16119:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(77232);let r=(e,t)=>(0,a.AH)(["&::before{color:",';content:"','";display:flex;font-size:16px;font-weight:600;height:100%;left:0;place-content:center;place-items:center;position:absolute;top:0;width:100%;}'],t,e)},28124:(e,t,n)=>{n.d(t,{A:()=>a});let a=n(77232).Ay.div.withConfig({componentId:"sc-83f4cbe3-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;font-weight:200;justify-content:center;letter-spacing:0.3px;mix-blend-mode:difference;padding-top:',"px;}"],({$hasColumns:e,theme:t})=>e?t.sizes.window.textTopPadding+t.sizes.fileManager.columnHeight:t.sizes.window.textTopPadding)},35377:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var a=n(37876),r=n(14232),i=n(77232),o=n(16119);let s=i.Ay.div.withConfig({componentId:"sc-4f9faf66-0"})(["&.drop{",";}"],(0,o.A)("Drop rom file here","#f1f1f1"));var l=n(79052),c=n(5145),d=n(74762),u=n(73100),f=n(28229),m=n(48940),p=n(65266),h=n(4622),y=n(38317),w=n(75970),b=n(57175),v=n(82909).Buffer;let g=(e,t)=>("Function"in t&&(e.constructor=t.Function),e),S=({containerRef:e,id:t,loading:n,setLoading:a,url:i})=>{let{exists:o,readFile:s}=(0,f.f)(),{createSnapshot:S}=(0,w.p)(),E=(0,d.A)(),{linkElement:A,processes:{[t]:{closing:F,libs:k=[]}={}}={}}=(0,m.N)(),{prependFileToTitle:C}=(0,u.A)(t),_=(0,r.useRef)(void 0),$=(0,b.A)(t,e),j=(0,r.useRef)(void 0),x=(0,r.useCallback)(async n=>{let r,i=$?.();if(!i)return;j.current=n,a(!0),e.current?.classList.remove("drop");try{i.EJS_terminate?.()}catch{}[...i.document.body.children].forEach(e=>e.remove());let d=i.document.createElement("div");d.id="emulator",d.style.placeContent="center",i.document.body.append(d),i.EJS_gameName=(0,l.basename)(n,(0,l.extname)(n));let[u,{core:f="",zip:m=!1}={}]=(r=(0,h.uQ)(n),Object.entries(c.W).find(([,{ext:e}])=>e.includes(r))||[]),w=await s(n);i.EJS_gameUrl=(0,h.Zd)(m?v.from(await (0,y.zipAsync)({[(0,l.basename)(n)]:w})):w),i.EJS_core=f;let b=`${(0,l.basename)(n)}.sav`,F=(0,l.join)(p.Sb,b);i.EJS_onGameStart=g(({detail:{emulator:e}})=>{(async()=>{await o(F)&&e.loadState?.(await s(F)),a(!1),E(i.FS,`EmulatorJs_${i.EJS_gameName}`),_.current=e;let n=e.elements?.container?.querySelector("canvas");n&&A(t,"peekElement",n)})()},i),i.EJS_onSaveState=g(({screenshot:e,state:t})=>{i.EJS_terminate?.(),t&&S(b,v.from(t),v.from(e))},i),i.EJS_player="#emulator",i.EJS_biosUrl="",i.EJS_pathtodata="Program Files/EmulatorJs/",i.EJS_startOnLoaded=!0,i.EJS_RESET_VARS=!0,i.EJS_Buttons={cacheManage:!1,loadState:!1,quickLoad:!1,quickSave:!1,saveState:!1,screenRecord:!1,screenshot:!1},await (0,h.aY)(k,void 0,void 0,void 0,i),C(`${i.EJS_gameName} (${u})`)},[e,S,o,$,t,k,A,E,C,s,a]);(0,r.useEffect)(()=>{i?i!==j.current&&x(i):F||(a(!1),e.current?.classList.add("drop"))},[F,e,x,a,i]),(0,r.useEffect)(()=>()=>{!n&&F&&_.current?.elements.buttons.saveState?.click()},[F,n])};var E=n(47825);let A=(0,r.memo)(({id:e})=>(0,a.jsx)(E.A,{StyledComponent:s,id:e,useHook:S}))},38317:(e,t,n)=>{n.d(t,{addEntryToZippable:()=>l,addFileToZip:()=>u,createZippable:()=>s,isFileInZip:()=>f,unarchive:()=>m,unzip:()=>c,zipAsync:()=>d});var a=n(79052),r=n(4622),i=n(65266),o=n(82909).Buffer;let s=(e,t)=>e.split("/").reduceRight((e,t)=>({[t]:e}),[t,i.X8]),l=(e,t)=>{let[[n,a]]=Object.entries(t);return e[n]=n in e?l(e[n],t[n]):a,e},c=e=>new Promise((t,a)=>{n.e(1071,"high").then(n.bind(n,21071)).then(({unzip:n})=>n(e,(e,n)=>e?a(e):t(n)))}),d=(e,t=i.X8)=>new Promise((a,r)=>{n.e(1071,"high").then(n.bind(n,21071)).then(({zip:n})=>n(e,t,(e,t)=>e?r(e):a(t)))}),u=async(e,t,n,a)=>o.from(await d(l(e.length>0&&await c(e)||{},s(n,await a(t))))),f=(e,t)=>new Promise((a,r)=>{n.e(1071,"high").then(n.bind(n,21071)).then(({unzip:n})=>n(e,(e,n)=>e?r(e):a(Object.keys(n).includes(t))))}),m=async(e,t)=>{if(window.SevenZip||await (0,r.aY)(["System/7zip/7zz.umd.js"]),!window.SevenZip)return{};let n=await window.SevenZip(),i=(0,a.basename)(e),s=(0,a.join)("/",(0,a.basename)(e,(0,a.extname)(e)));n.FS.mkdir(s),n.FS.chdir(s);let l=n.FS.open(i,"w+");n.FS.write(l,t,0,t.length),n.FS.close(l),n.callMain(["-y","x",i]);let c=n.FS.readdir(s),d=e=>(t,r)=>{if([".","..",i].includes(r))return t;let l=(0,a.join)(e,r),c=l.replace(s,"");try{n.FS.chmod(l,511)}catch{}return Object.assign(t,n.FS.isDir(n.FS.stat(l).mode)?{[(0,a.join)(c,"/")]:o.from(""),...n.FS.readdir(l).reduce(d(l),{})}:{[c]:n.FS.readFile(l,{flags:"r"})}),t};return c.reduce(d(s),{})}},47825:(e,t,n)=>{n.d(t,{A:()=>d});var a=n(37876),r=n(14232),i=n(77232),o=n(28124),s=n(58196),l=n(48940);let c=i.Ay.div.withConfig({componentId:"sc-e37924df-0"})([""]),d=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:i})=>{let{processes:{[e]:{url:d=""}={}}}=(0,l.N)(),u=(0,r.useRef)(null),[f,m]=(0,r.useState)(!0),p=(0,r.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:u,id:e,loading:f,setLoading:m,url:d}),(0,a.jsxs)(a.Fragment,{children:[f&&(0,a.jsx)(o.A,{}),(0,a.jsx)(n||c,{ref:u,style:p,...(0,s.A)({id:e}),children:i})]})})},57175:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(14232),r=n(58196),i=n(65266),o=n(48940),s=n(92336);let l=(e,t,n,l,c=!1)=>{let[d,u]=(0,a.useState)(),[f,m]=(0,a.useState)(),{onDragOver:p,onDrop:h}=(0,r.A)({id:e}),{processes:{[e]:{maximized:y}={}}={}}=(0,o.N)(),{foregroundId:w,setForegroundId:b}=(0,s.w)(),v=(0,a.useCallback)(()=>{let t;if(!d)return;d.querySelector("iframe")?.remove();let n=((e,t,n)=>{let a=document.createElement("iframe");a.title=e,a.style.backgroundColor="transparent",a.style.border="0",a.style.width="100%",a.style.height="100%",t.append(a);let r=a.contentDocument;r.open(),r.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),r.close();let i=a.contentWindow;return i.document.documentElement.style.height="100%",i.document.documentElement.style.width="100%",i.document.body.style.height="100%",i.document.body.style.width="100%",i.document.body.style.margin="0",i.document.body.style.overflow="hidden",a})(e,d,l),a=n.contentWindow;(e=>{let t=e.HTMLCanvasElement.prototype.getContext;e.HTMLCanvasElement.prototype.getContext=function(e,n){return("webgl"===e||"webgl2"===e)&&(n=Object.assign(n||{},{preserveDrawingBuffer:!0})),t.call(this,e,n)}})(a),c&&(t=(e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t})(n.contentDocument));let r=()=>{c&&t?t.focus(i.VD):a.focus(),b(e)};return a.addEventListener("click",r),a.addEventListener("focus",r),a.addEventListener("blur",()=>b("")),a.addEventListener("dragover",p),a.addEventListener("drop",h),m(a),a},[d,e,p,h,b,l,c]);return(0,a.useLayoutEffect)(()=>{f&&w===e&&requestAnimationFrame(()=>{n?n(f):c?f.document.querySelector("canvas")?.focus(i.VD):f.focus()})},[f,n,w,e,y,c]),(0,a.useEffect)(()=>{if(!d){let e=()=>{requestAnimationFrame(()=>{t.current?u(t.current):e()})};e()}},[d,t]),(0,a.useMemo)(()=>d?v:void 0,[d,v])}},58196:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(79052),r=n(14232),i=n(58688),o=n(59029),s=n(35575),l=n(28229),c=n(48940),d=n(92336),u=n(65266),f=n(4622),m=n(65287);let p=({callback:e,directory:t=u.Bn,id:n,onDragLeave:p,onDragOver:h,updatePositions:y})=>{let{url:w}=(0,c.N)(),b=(0,m.w)(),{iconPositions:v,sortOrders:g,setIconPositions:S}=(0,d.w)(),{exists:E,mkdirRecursive:A,updateFolder:F,writeFile:k}=(0,l.f)(),C=(0,r.useCallback)(async(e,t,r)=>{if(n)if(t){let i=(0,a.join)(u.Bn,e);if(await A(u.Bn),await k(i,t,!0))return r===s.z.UPDATE_URL&&w(n,i),F(u.Bn,e),(0,a.basename)(i)}else r===s.z.UPDATE_URL&&w(n,e);return""},[n,A,F,w,k]),{openTransferDialog:_}=(0,i.A)();return{onDragLeave:p,onDragOver:(0,r.useCallback)(e=>{h?.(e),(0,f.CH)(e)},[h]),onDrop:(0,r.useCallback)(r=>{if(u.jj.has((0,f.uQ)(t)))return;if(r.target instanceof HTMLElement){if(r.target.closest(".focus-within")?.contains(r.target))return;if(y){let{files:e,text:n}=(0,o.bn)(r);if(0===e.length&&""===n)return;(async()=>{let i={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,a.basename)(e)===(0,a.relative)(t,e))return;o=o.map(e=>(0,a.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await (0,f.$I)(o,t,v,E),(0,f.$Y)(t,r.target,v,g,i,o,S,E)})()}}let i="string"==typeof n;i&&!y&&t===u.Bn&&b.current[n]?.componentWindow?.focus(u.VD),(0,o.nX)(r,e||C,t,_,i)},[e,t,E,v,n,_,b,S,g,y,C])}}},73100:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(14232),r=n(48940),i=n(31157),o=n(65266);let s=e=>{let{title:t}=(0,r.N)(),[n]=(0,a.useMemo)(()=>e.split(o.QB),[e]),{title:s}=i.A[n]||{};return{appendFileToTitle:(0,a.useCallback)((n,a)=>{let r=n?` - ${n}${a?` ${o.g6}`:""}`:"";t(e,`${s}${r}`)},[e,s,t]),prependFileToTitle:(0,a.useCallback)((n,a,r)=>{let i=n?`${a?`${o.g6} `:""}${n}${r?" ":" - "}`:"";t(e,`${i}${s}`)},[e,s,t])}}},74762:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(14232),r=n(28229);let i=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.f)(),i=(0,a.useRef)("");return(0,a.useEffect)(()=>()=>{if(i.current){let e=i.current;i.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,a.useCallback)(async(t,a)=>{if(!t)return;let r="";try{r=await e(t,a)}catch{}r&&(n("/",r),i.current=r)},[e,n])}},75970:(e,t,n)=>{n.d(t,{p:()=>s});var a=n(79052),r=n(14232),i=n(28229),o=n(65266);let s=()=>{let{createPath:e,updateFolder:t}=(0,i.f)();return{createSnapshot:(0,r.useCallback)(async(n,r,i,s=!0,l=o.Sb)=>{let c="";try{if((c=await e(n,l,r,void 0,s))&&i)try{let t="function"==typeof i?await i():i;t&&await e(`${(0,a.join)(l,c)}${o.V9}`,o.jv,t,void 0,s)}catch{}t((0,a.dirname)(l)),t(l,c)}catch{}return c},[e,t])}}}}]);